<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.syllabus">
	<resultMap id="syllabusResult" type="SyllabusVO">
		<result property="id" column="slb_id" />
		<result property="name" column="slb_name" />
        <result property="reportName" column="slb_report_name" />
        <result property="type" column="slb_type" />
        <result property="category" column="slb_category" />
        <result property="overview" column="slb_overview" />
        <result property="objectives" column="slb_objectives" />
        <result property="target" column="slb_target" />
        <result property="contents" column="slb_contents" />
        <result property="joinDate" column="slb_join_date" />
        <result property="modDate" column="slb_mod_date" />
        <result property="days" column="slb_days" />
        <result property="time" column="slb_time" />
        <collection property="courseCategoryVO" resultMap="crscResult" />
	</resultMap> 
	
	<resultMap id="crscResult" type="CourseCategoryVO">
		<result property="id" column="crs_category_id" />
		<result property="name" column="crs_category_name" />
	</resultMap>
	
	 <sql id="syllabus-columns">
   	<![CDATA[
   		S.slb_id as slb_id, S.slb_name as slb_name, S.slb_report_name as slb_report_name, S.slb_type as slb_type, S.slb_category as slb_category, 
         S.slb_overview as slb_overview, S.slb_objectives as slb_objectives, S.slb_target as slb_target, S.slb_contents as slb_contents, SUBSTR(S.slb_join_date, 0, 10) as slb_join_date,
          SUBSTR(S.slb_mod_date, 0, 10) as slb_mod_date, S.slb_days as slb_days, S.slb_time as slb_time, C.crs_category_id as crs_category_id, C.crs_category_name as crs_category_name FROM syllabus S
          LEFT JOIN course_category C
          ON s.crs_category_id = c.crs_category_id
   	]]>
   </sql>
	
	<select id="selectAllSyllabusList" resultMap="syllabusResult">
         SELECT  <include refid="syllabus-columns"></include> 
         ORDER BY slb_join_date
	</select>
	
		
	<select id="selectSyllabus" parameterType="int" resultMap="syllabusResult">
	 	SELECT  <include refid="syllabus-columns"></include>
	 	WHERE slb_id = #{id}
	</select>
	
	<insert id="insertSyllabus" parameterType="SyllabusVO">
	  <![CDATA[
	  	insert into syllabus(slb_id, slb_name, slb_report_name, slb_type, slb_category, 
	  	slb_overview, slb_objectives, slb_target, slb_contents, slb_days, slb_time, crs_category_id)
	  	values(slb_seq.NEXTVAL, #{name}, #{reportName}, #{type}, #{category}, 
	  	#{overview}, #{objectives}, #{target}, #{contents}, #{days}, #{time}, #{courseCategoryVO.id})
	  ]]>
	</insert>
	
	<update id="updateSyllabus" parameterType="SyllabusVO" >
	 <![CDATA[
	 	update syllabus set slb_name = #{name}, slb_report_name = #{reportName}, slb_type = #{type},
		slb_category = #{category}, slb_overview = #{overview}, slb_objectives = #{objectives},
		slb_target = #{target}, slb_contents = #{contents}, slb_mod_date = TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MISS'),
		slb_days = #{days}, slb_time = #{time}, crs_category_id = #{courseCategoryVO.id}
		where slb_id = #{id}
	 ]]> 
	</update>
	
	<delete id="deleteSyllabus" parameterType="int">
	  <![CDATA[
	    delete from syllabus where slb_id = #{id }
	  ]]>
	</delete>
	
	
</mapper>